<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="referrer" content="no-referrer" />
    <title>Dashboard - Razepedia</title>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <style>
      * { margin: 0; padding: 0; box-sizing: border-box; font-family: "Segoe UI", sans-serif; }
      html { scroll-behavior: smooth; }

      body {
        min-height: 100vh;
        background: linear-gradient(135deg, #8b5cf6, #d946ef);
        padding: 20px 10px;
        overflow-y: auto;
        overflow-x: hidden;
        display: flex;
        align-items: flex-start;
        justify-content: center;
        position: relative;
      }

      @media (min-width: 1024px) {
        .card { width: 100vw !important; max-width: none !important; min-height: 100vh;
                border-radius: 0 !important; padding: 60px 40px; margin: 0 !important; }
      }

      .card {
        position: relative; z-index: 10; width: 380px; max-width: 95vw;
        background: rgba(255,255,255,0.18); backdrop-filter: blur(20px);
        border-radius: 30px; padding: 40px 30px;
        box-shadow: 0 25px 50px rgba(0,0,0,0.4);
        border: 1px solid rgba(255,255,255,0.3);
        text-align: center; animation: fade 1s ease-out; margin: 20px auto;
      }
      @keyframes fade { from { opacity: 0; transform: scale(0.9); } to { opacity: 1; transform: scale(1); } }

      /* === REDEEM & TRANSFER SECTION === */
      .feature-section { margin: 40px 0; }
      .redeem-box, .transfer-box {
        background: rgba(0,0,0,0.3);
        padding: 20px;
        border-radius: 20px;
        margin-bottom: 25px;
      }
      .redeem-box h3, .transfer-box h3 {
        color: #fff; margin-bottom: 15px; font-size: 20px;
      }
      .input-group {
        display: flex; gap: 10px; align-items: center;
      }
      .input-group input {
        flex: 1; padding: 14px; border-radius: 12px;
        border: none; background: rgba(255,255,255,0.15);
        color: #fff; font-size: 16px;
      }
      .input-group input::placeholder { color: rgba(255,255,255,0.6); }
      .btn {
        padding: 14px 24px; background: #00d4ff; color: white;
        border: none; border-radius: 12px; cursor: pointer;
        font-weight: 600; transition: 0.3s;
      }
      .btn:hover { background: #00b0ff; transform: translateY(-2px); }
      .btn-transfer {
        background: #4facfe; width: 100%; margin-top: 15px;
      }
      .btn-transfer:hover { background: #3d8bfe; }

      /* Border aktif lebih kecil */
      .border-active img {
        width: 100%; max-width: 220px; height: auto;
        border-radius: 0 !important; box-shadow: 0 0 30px rgba(0,212,255,0.7);
      }

      /* Sisanya sama seperti versi sebelumnya */
      .avatar { width: 110px; height: 110px; border-radius: 50%; object-fit: cover;
                border: 5px solid #00d4ff; box-shadow: 0 0 30px rgba(0,212,255,0.7);
                cursor: pointer; transition: 0.3s; margin-bottom: 20px; }
      .avatar:hover { transform: scale(1.1); }
      h1 { font-size: 26px; color: #00d4ff; margin: 10px 0; }
      .rank { font-size: 18px; color: #ffa726; font-weight: 600; margin-bottom: 20px; }
      .info { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin: 25px 0; }
      .box { background: rgba(0,212,255,0.15); padding: 14px; border-radius: 18px;
             border: 1px solid rgba(0,212,255,0.4); }
      .box strong { font-size: 22px; display: block; color: #00d4ff; }
      .stats { display: grid; grid-template-columns: repeat(4,1fr); gap: 12px; margin: 30px 0; }
      .stat { background: rgba(0,212,255,0.2); padding: 12px; border-radius: 15px;
              border: 1px solid #00d4ff; text-align: center; }
      .stat h3 { font-size: 20px; color: #00d4ff; }
      .border-list { display: flex; justify-content: center; gap: 18px; margin-top: 20px; flex-wrap: wrap; }
      .b-thumb { width: 76px; height: 96px; cursor: pointer; border-radius: 14px;
                 overflow: hidden; border: 4px solid transparent; transition: all 0.3s;
                 transform: scale(0.94); background: #1e1e2e; box-shadow: 0 4px 15px rgba(0,0,0,0.5); }
      .b-thumb:hover { transform: scale(1.02); }
      .b-thumb.active { border: 4px solid #00d4ff; transform: scale(1.08); box-shadow: 0 0 30px #00d4ff; }
      .b-thumb img { width: 100%; height: 100%; object-fit: contain; }
      .logout a { display: inline-block; padding: 12px 40px; background: #ff6b6b;
                  color: white; border-radius: 50px; text-decoration: none;
                  font-weight: 600; margin-top: 40px; box-shadow: 0 5px 15px rgba(255,107,107,0.4); transition: 0.3s; }
      .logout a:hover { background: #ff5252; transform: translateY(-3px); }
      .preloader { display: none; }
    </style>
  </head>
  <body>

    <div class="preloader">
      <img src="https://i.imgur.com/fALj8Ot.png" alt="" />
      <img src="https://i.imgur.com/HX0Wg22.png" alt="" />
      <img src="https://i.imgur.com/bB5zrV3.gif" alt="" />
      <img src="https://i.imgur.com/YyU1klC.gif" alt="" />
      <img src="https://imgur.com/ml9fDX4.gif" alt="" />
    </div>

    <div class="bg-circles">
      <div class="circle"></div>
      <div class="circle"></div>
      <div class="circle"></div>
    </div>

    <div class="card">
      <img src="https://via.placeholder.com/110/1e1e2e/00D4FF?text=A" class="avatar" id="profilePic" />
      <input type="file" id="fileInput" accept="image/*" style="display:none" />

      <h1>Halo, <span id="username">razepedia</span>!</h1>
      <div class="rank">Bronze III</div>

      <div class="info">
        <div class="box"><small>Slot Tersedia</small><strong id="slotCount">18</strong></div>
        <div class="box"><small>Total Point</small><strong>1350</strong></div>
      </div>

      <div class="stats">
        <div class="stat"><h3>9</h3><small>Main</small></div>
        <div class="stat"><h3>4</h3><small>Menang</small></div>
        <div class="stat"><h3>44%</h3><small>Winrate</small></div>
        <div class="stat"><h3>0</h3><small>MVP</small></div>
      </div>

      <!-- ==== REDEEM CODE ==== -->
      <div class="feature-section">
        <div class="redeem-box">
          <h3>Redeem Kode</h3>
          <div class="input-group">
            <input type="text" id="redeemInput" placeholder="Masukkan kode redeem" />
            <button class="btn" onclick="claimRedeem()">Claim</button>
          </div>
        </div>

        <!-- ==== TRANSFER SLOT ==== -->
        <div class="transfer-box">
          <h3>Transfer Slot</h3>
          <p style="color:#ccc; font-size:14px; margin-bottom:15px;">
            Kirim slot ke pemain lain dengan cepat & aman.
          </p>
          <button class="btn btn-transfer" onclick="openTransferModal()">Mulai Transfer Slot</button>
        </div>
      </div>

      <div class="border-active">
        <p>Border Aktif</p>
        <img src="https://i.imgur.com/fALj8Ot.png" alt="Border" id="activeBorder" />
      </div>

      <p style="color:#d4f1ff; margin:20px 0 10px; font-weight:600;">Pilih Border</p>
      <div class="border-list">
        <div class="b-thumb active" data-url="https://i.imgur.com/fALj8Ot.png">
          <img src="https://i.imgur.com/fALj8Ot.png" referrerpolicy="no-referrer" />
        </div>
        <div class="b-thumb" data-url="https://i.imgur.com/HX0Wg22.png">
          <img src="https://i.imgur.com/HX0Wg22.png" referrerpolicy="no-referrer" />
        </div>
        <div class="b-thumb" data-url="https://i.imgur.com/bB5zrV3.gif">
          <img src="https://i.imgur.com/bB5zrV3.gif" referrerpolicy="no-referrer" />
        </div>
        <div class="b-thumb" data-url="https://i.imgur.com/YyU1klC.gif">
          <img src="https://i.imgur.com/YyU1klC.gif" referrerpolicy="no-referrer" />
        </div>
        <div class="b-thumb" data-url="https://imgur.com/ml9fDX4.gif">
          <img src="https://imgur.com/ml9fDX4.gif" referrerpolicy="no-referrer" />
        </div>
      </div>

      <div class="logout">
        <a href="#" id="logoutBtn">Keluar Akun</a>
      </div>
    </div>

    <script>
      const currentUser = localStorage.getItem("currentUser") || "razepedia";
      if (!localStorage.getItem("currentUser")) {
        Swal.fire("Login Dulu!","Silakan login terlebih dahulu","warning")
          .then(() => location.href = "login.html");
      }
      document.getElementById("username").textContent = currentUser;

      // === INIT SLOT USER ===
      if (!localStorage.getItem("slot_" + currentUser)) {
        localStorage.setItem("slot_" + currentUser, "18");
      }
      document.getElementById("slotCount").textContent = localStorage.getItem("slot_" + currentUser);

      // === REDEEM CODE ===
      function claimRedeem() {
        const code = document.getElementById("redeemInput").value.trim();
        if (!code) return Swal.fire("Error","Masukkan kode dulu!","warning");

        // Contoh kode redeem (bisa ditambah sesukamu)
        const validCodes = {
          "RAZE2025": 10,
          "FREESLOT": 5,
          "WELCOME": 15
        };

        if (validCodes[code]) {
          const bonus = validCodes[code];
          const current = parseInt(localStorage.getItem("slot_" + currentUser)) || 0;
          localStorage.setItem("slot_" + currentUser, current + bonus);
          document.getElementById("slotCount").textContent = current + bonus;
          document.getElementById("redeemInput").value = "";
          Swal.fire("Sukses!",`Kamu mendapatkan +${bonus} slot!`,"success");
        } else {
          Swal.fire("Gagal","Kode redeem tidak valid atau sudah digunakan","error");
        }
      }

      // === TRANSFER SLOT ===
      function openTransferModal() {
        Swal.fire({
          title: "Transfer Slot",
          html: `
            <input id="targetUser" class="swal2-input" placeholder="Username tujuan">
            <input id="transferAmount" class="swal2-input" type="number" min="1" placeholder="Jumlah slot">
          `,
          showCancelButton: true,
          confirmButtonText: "Transfer",
          preConfirm: () => {
            const target = document.getElementById("targetUser").value.trim();
            const amount = parseInt(document.getElementById("transferAmount").value);

            if (!target) return Swal.showValidationMessage("Username tujuan wajib diisi");
            if (!amount || amount <= 0) return Swal.showValidationMessage("Masukkan jumlah yang valid");
            if (amount > parseInt(localStorage.getItem("slot_" + currentUser))) {
              return Swal.showValidationMessage("Slot kamu tidak cukup!");
            }

            // Cek apakah user tujuan ada di "database" (localStorage)
            if (!localStorage.getItem("slot_" + target) && target !== currentUser) {
              return Swal.showValidationMessage("Username tidak ditemukan!");
            }

            // Proses transfer
            const senderSlot = parseInt(localStorage.getItem("slot_" + currentUser));
            const receiverSlot = parseInt(localStorage.getItem("slot_" + target)) || 0;

            localStorage.setItem("slot_" + currentUser, senderSlot - amount);
            localStorage.setItem("slot_" + target, receiverSlot + amount);

            // Update tampilan
            document.getElementById("slotCount").textContent = senderSlot - amount;

            Swal.fire(
              "Transfer Berhasil!",
              `Kamu berhasil transfer ${amount} slot ke @${target}`,
              "success"
            );
          }
        });
      }

      // === GANTI FOTO PROFIL (tetap sama) ===
      document.getElementById("profilePic").onclick = () => document.getElementById("fileInput").click();
      document.getElementById("fileInput").onchange = e => {
        const f = e.target.files[0];
        if (f && f.size <= 2*1024*1024) {
          const r = new FileReader();
          r.onload = ev => {
            document.getElementById("profilePic").src = ev.target.result;
            localStorage.setItem("pic_"+currentUser, ev.target.result);
            Swal.fire("Sukses!","Foto profil diperbarui","success");
          };
          r.readAsDataURL(f);
        } else Swal.fire("Error","Max 2MB!","error");
      };
      const savedPic = localStorage.getItem("pic_"+currentUser);
      if (savedPic) document.getElementById("profilePic").src = savedPic;

      // === GANTI BORDER (instan) ===
      const activeImg = document.getElementById("activeBorder");
      document.querySelectorAll(".b-thumb").forEach(thumb => {
        thumb.onclick = () => {
          document.querySelectorAll(".b-thumb").forEach(x => x.classList.remove("active"));
          thumb.classList.add("active");
          const newUrl = thumb.dataset.url;
          activeImg.style.opacity = "0.6";
          activeImg.src = newUrl;
          activeImg.onload = () => activeImg.style.opacity = "1";
          localStorage.setItem("border_"+currentUser, newUrl);
        };
      });
      const savedBorder = localStorage.getItem("border_"+currentUser);
      if (savedBorder) {
        activeImg.src = savedBorder;
        document.querySelectorAll(".b-thumb").forEach(t => {
          if (t.dataset.url === savedBorder) t.classList.add("active");
        });
      }

      // === LOGOUT ===
      document.getElementById("logoutBtn").onclick = e => {
        e.preventDefault();
        localStorage.removeItem("currentUser");
        Swal.fire({icon:"success",title:"Sampai jumpa!",timer:1500,showConfirmButton:false})
          .then(() => location.href = "login.html");
      };
    </script>
  </body>
</html>
